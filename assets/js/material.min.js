/* Material '18 by MartonDev
  https://martondev.github.io/Material-Design-18/
  Licensed under the MIT license
 */

var navOpened = false;

$(document).ready(function() {

  Waves.init();
  Waves.attach('.waves-effect', ['waves-button', 'waves-float']);

  var navProtector = document.createElement("DIV");

  $(navProtector).addClass("nav-protector");
  $("#sidenav").after(navProtector);

  $("#menuTrigger").click(function() {

    if(navOpened) {

      $("#sidenav").css("width", "0");
      $("#main").css("margin-left", "0");
      $("footer").css("margin-left", "0");

      $("#menuTrigger .close").fadeOut();
      $("#menuTrigger .menu").fadeIn();

      navOpened = false;

    }else {

      $("#sidenav").css("width", "250px");
      $("#main").css("margin-left", "250px");
      $("footer").css("margin-left", "250px");

      $("#menuTrigger .menu").fadeOut();
      $("#menuTrigger .close").fadeIn();

      navOpened = true;

    }

  });

  $(".code").click(function() {

  	this.select();
  	document.execCommand("copy");

  });

  $('input[type="range"]').on('input', function() {

    if(!($(this).attr("disabled"))) {

      var control = $(this);
      var controlMin = control.attr('min');
      var controlMax = control.attr('max');
      var controlVal = control.val();
      var controlThumbWidth = control.data('thumbwidth');
      var range = controlMax - controlMin;
      var position = ((controlVal - controlMin) / range) * 100;
      var positionOffset = Math.round(controlThumbWidth * position / 100) - (controlThumbWidth / 2);
      var output = control.next('output');

      output.css('left', 'calc(' + position + '% - ' + positionOffset + 'px)');
      output.html("<span>" + controlVal + "</span>");

    }

  });

});

jQuery(function($) {

  $('.field-input').focus(function() {

    $(this).parent().addClass('is-focused has-label');

    for(var i = 0; i < document.getElementsByClassName("character-counter").length; i++) {

      if($(document.getElementsByClassName("character-counter")[i]).attr("countChar") == $(this).attr("id")) {

        if($(this).parent().hasClass("success")) {

          $(document.getElementsByClassName("character-counter")[i]).css("color", "#64dd17");

        }else if($(this).parent().hasClass("warning")) {

          $(document.getElementsByClassName("character-counter")[i]).css("color", "#ffab00");

        }else if($(this).parent().hasClass("error")) {

          $(document.getElementsByClassName("character-counter")[i]).css("color", "#dd2c00");

        }else {

          $(document.getElementsByClassName("character-counter")[i]).css("color", "#1a73e8");

        }

      }

    }

  });

  $(".field-input").each(function() {

    if($(this).val() != "") {

      $(this).parent().addClass("has-label");

    }

  });

  $("select").each(function() {

    var dropdownTitle = $(this).attr("select-title");
    var dropdownId = $(this).attr("id") + "Dropdown";
    var options = "";

    $(this).append('<option value="" selected disabled></option>');

    $($(this).attr("id") + " option").each(function() {

      if($(this).html() != "") {

        options += '<li class="waves-effect" value="' + $(this).attr("value") + '">' + $(this).html() + '</li>';

      }

    });

    $(this).after('<div class="dropdown" id="' + dropdownId + '" select-id="' + $(this).attr("id") + '"><div class="dropdown-header waves-effect" onclick="toggleDropdown(' + dropdownId + 'Ul)" id="' + dropdownId + 'Header"><h1>' + dropdownTitle + '</h1><i class="material-icons">arrow_drop_down</i></div><ul id="' + dropdownId + 'Ul">' + options + '</ul></div>');

    var ulWidth = $("#" + dropdownId + "Header").width() + 24;

    $("#" + dropdownId + "Ul").css("width", ulWidth + "px");

    if($($("#" + dropdownId + "Header").parent().attr("select-id")).attr("disabled")) {

      $("#" + dropdownId + "Header").css("cursor", "not-allowed");

    }

  });

  $(window).click(function() {

    $(".dropdown ul").each(function() {

      if($(this).css("display") == "block") {

        toggleDropdown(this);

      }

    });

  });

  $(".dropdown-header").click(function(event) {

    event.stopPropagation();

  });

  $(".dropdown ul li").click(function() {

    $("#" + $($(this).parent()).parent().attr("select-id")).val($(this).attr("value"));
    $("#" + $($(this).parent()).parent().attr("id") + "Header h1").html($(this).html());

  });

  $(".character-counter").each(function() {

    $(this).html("0");

  });

  $('input[type=text], input[type=email], input[type=tel], input[type=url], input[type=password], input[type=search], textarea').each(function() {

    $(this).keyup(function() {

      for(var i = 0; i < document.getElementsByClassName("character-counter").length; i++) {

        if($(document.getElementsByClassName("character-counter")[i]).attr("countChar") == $(this).attr("id")) {

          $(document.getElementsByClassName("character-counter")[i]).html($(this).val().length);

        }

      }

    });

  });

  $('.field-input').blur(function() {

    $parent = $(this).parent();

    if($(this).val() == '') {

      $parent.removeClass('has-label');

    }

    $parent.removeClass('is-focused');

    for(var i = 0; i < document.getElementsByClassName("character-counter").length; i++) {

      if($(document.getElementsByClassName("character-counter")[i]).attr("countChar") == $(this).attr("id")) {

        $(document.getElementsByClassName("character-counter")[i]).css("color", "#5f6368");

      }

    }

  });

  $(".checkbox-field").each(function() {

    $(this).find("span.checkbox").html('<i class="material-icons checked-icon">check_box</i><i class="material-icons unchecked-icon">check_box_outline_blank</i>');
    $(this).find("span.checkbox .material-icons.unchecked-icon").css("margin-left", "-" + $(this).find("span.checkbox .material-icons.unchecked-icon").css("font-size"));

    if($(this).find("input[type=checkbox]").is(":checked")) {

      $(this).find("span.checkbox").addClass("checked-checkbox");

    }else {

      $(this).find("span.checkbox").removeClass("checked-checkbox");

    }

  });

  $(".checkbox-field").click(function() {

    if($(this).find("input[type=checkbox]").is(":checked")) {

      $(this).find("span.checkbox i.material-icons").html("check_box");
      $(this).find("span.checkbox").addClass("checked-checkbox");

    }else {

      $(this).find("span.checkbox i.material-icons").html("check_box_outline_blank");
      $(this).find("span.checkbox").removeClass("checked-checkbox");

    }

  });

})

function toggleDropdown(dropdownUl) {

  var dropdownHeader = "#" + $(dropdownUl).attr("id").replace("Ul", "Header");

  if($(dropdownUl).css("display") == "none" && !($($(dropdownHeader).parent().attr("select-id")).attr("disabled"))) {

    $(dropdownUl).css("display", "block");
    $(dropdownHeader).css("margin-bottom", "-5px");
    $(dropdownHeader).css("border-bottom-left-radius", "0");
    $(dropdownHeader).css("border-bottom-right-radius", "0");

  }else {

    $(dropdownUl).css("display", "none");
    $(dropdownHeader).css("margin-bottom", "7px");
    $(dropdownHeader).css("border-bottom-left-radius", "8px");
    $(dropdownHeader).css("border-bottom-right-radius", "8px");

  }

}
